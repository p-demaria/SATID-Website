<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETF Analysis: Market Event - Covid</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-section {
            background: white;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: bold;
            color: #555;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .tables-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .correlation-tables {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .table-container {
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .table-title {
            font-size: 12px;
            font-weight: bold;
            color: #003366;
            margin-bottom: 10px;
            text-align: center;
            background-color: #003366;
            color: white;
            padding: 8px;
            border-radius: 4px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }
        
        th {
            background-color: #003366;
            color: white;
            padding: 6px 4px;
            text-align: center;
            font-weight: bold;
            font-size: 10px;
        }
        
        td {
            padding: 6px 4px;
            text-align: center;
            border: 1px solid #ddd;
            background-color: white;
        }
        
        .etf-label {
            font-weight: bold;
            background-color: #003366;
            color: white;
        }
        
        .correlation-high {
            background-color: #e6f2ff;
        }
        
        .metrics-tables {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .legend-container {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .legend-item {
            display: inline-block;
            margin-right: 15px;
            margin-bottom: 5px;
        }
        
        .legend-color {
            display: inline-block;
            width: 20px;
            height: 12px;
            border-radius: 2px;
            margin-right: 5px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Market Event - Covid</h1>
        
        <div class="content-grid">
            <!-- Left: Chart -->
            <div class="chart-section">
                <div class="chart-title">ETF Performance (Base 100: Dec 2019)</div>
                <canvas id="etfChart"></canvas>
                <div class="legend-container" id="chartLegend"></div>
            </div>
            
            <!-- Right: Correlation Tables -->
            <div class="tables-section">
                <div class="correlation-tables">
                    <div class="table-container">
                        <div class="table-title">Correlation 2019</div>
                        <table id="corr2019Table"></table>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-title">Max Correlation 2020</div>
                        <table id="corr2020Table"></table>
                    </div>
                </div>
                
                <!-- Metrics Tables -->
                <div class="metrics-tables">
                    <div class="table-container">
                        <div class="table-title">Volatility (Dec 2019)</div>
                        <table id="vol2019Table"></table>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-title">Drawdown & Volatility (Sept 2020)</div>
                        <table id="metrics2020Table"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Embedded data
        const data = {
        "dates": [
                "2019-12-31",
                "2020-01-02",
                "2020-01-03",
                "2020-01-06",
                "2020-01-07",
                "2020-01-08",
                "2020-01-09",
                "2020-01-10",
                "2020-01-13",
                "2020-01-14",
                "2020-01-15",
                "2020-01-16",
                "2020-01-17",
                "2020-01-21",
                "2020-01-22",
                "2020-01-23",
                "2020-01-24",
                "2020-01-27",
                "2020-01-28",
                "2020-01-29",
                "2020-01-30",
                "2020-01-31",
                "2020-02-03",
                "2020-02-04",
                "2020-02-05",
                "2020-02-06",
                "2020-02-07",
                "2020-02-10",
                "2020-02-11",
                "2020-02-12",
                "2020-02-13",
                "2020-02-14",
                "2020-02-18",
                "2020-02-19",
                "2020-02-20",
                "2020-02-21",
                "2020-02-24",
                "2020-02-25",
                "2020-02-26",
                "2020-02-27",
                "2020-02-28",
                "2020-03-02",
                "2020-03-03",
                "2020-03-04",
                "2020-03-05",
                "2020-03-06",
                "2020-03-09",
                "2020-03-10",
                "2020-03-11",
                "2020-03-12",
                "2020-03-13",
                "2020-03-16",
                "2020-03-17",
                "2020-03-18",
                "2020-03-19",
                "2020-03-20",
                "2020-03-23",
                "2020-03-24",
                "2020-03-25",
                "2020-03-26",
                "2020-03-27",
                "2020-03-30",
                "2020-03-31",
                "2020-04-01",
                "2020-04-02",
                "2020-04-03",
                "2020-04-06",
                "2020-04-07",
                "2020-04-08",
                "2020-04-09",
                "2020-04-13",
                "2020-04-14",
                "2020-04-15",
                "2020-04-16",
                "2020-04-17",
                "2020-04-20",
                "2020-04-21",
                "2020-04-22",
                "2020-04-23",
                "2020-04-24",
                "2020-04-27",
                "2020-04-28"
        ],
        "chart_data": {
                "SPY": [
                        100.0,
                        100.935225235328,
                        100.17091410624776,
                        100.55309030386643,
                        100.27032427874754,
                        100.80473132997834,
                        101.48826395649803,
                        101.1962336791059,
                        101.89215646930062,
                        101.73684097044384,
                        101.96674504829326,
                        102.81492964171794,
                        103.13496932325464,
                        102.93296116761765,
                        102.94541323052833,
                        103.06348602258517,
                        102.14691309027498,
                        100.50954419156656,
                        101.56282158587287,
                        101.47891717191058,
                        101.80828300495617,
                        99.95964169833759,
                        100.70222619569465,
                        102.2370177443444,
                        103.4176528160593,
                        103.76562968596556,
                        103.21263223095265,
                        103.98311265052217,
                        104.16335290827882,
                        104.83444378842717,
                        104.72259186955601,
                        104.89036974786275,
                        104.62008673527232,
                        105.12027382571219,
                        104.6884028583829,
                        103.61032450364809,
                        100.17401938457098,
                        97.13855308266963,
                        96.78123974471518,
                        92.4346135161314,
                        92.04624739494488,
                        96.03245500725099,
                        93.2828290591739,
                        97.2038051936141,
                        93.97256192580076,
                        92.41909744105465,
                        85.2016465609352,
                        89.61040930560095,
                        85.24204612875475,
                        77.08632663421977,
                        83.67616568898544,
                        74.52000495606546,
                        78.54349654132862,
                        74.5665996057225,
                        74.72505649078995,
                        71.50483644519704,
                        69.67659093673454,
                        75.98951344415292,
                        77.1270872809141,
                        81.63053006481985,
                        79.1991126125573,
                        81.77115481174224,
                        80.55231759507438,
                        76.9270908504367,
                        78.70220618160845,
                        77.56462202830797,
                        82.77434024957564,
                        82.85872438261445,
                        85.64018717090885,
                        86.94340852061548,
                        86.14956113957732,
                        88.69039064917132,
                        86.80589936855559,
                        87.22463738138173,
                        89.58105875135006,
                        88.00283457233252,
                        85.33077868309995,
                        87.22463738138173,
                        87.21840619165675,
                        88.43411749692284,
                        89.70920048574393,
                        89.29666271302493
                ],
                "VGK": [
                        100.0,
                        100.83618308819959,
                        99.57338268905114,
                        99.94882973373916,
                        99.45393579474873,
                        99.70989678221815,
                        99.81229214282247,
                        99.33448106786307,
                        99.82934367652058,
                        99.89764380231186,
                        99.93175470229134,
                        100.40956577725073,
                        100.80205652305365,
                        100.06827662804159,
                        100.17066415606266,
                        99.76108271364545,
                        99.40273419815495,
                        97.35496013998393,
                        98.3617917190797,
                        98.4812307807989,
                        98.43004484937158,
                        96.91126779758726,
                        96.9453943627332,
                        98.56655894253862,
                        99.53924045873873,
                        99.70989678221815,
                        98.75429029746584,
                        99.06144504894581,
                        99.7952327765411,
                        100.40956577725073,
                        99.74402334736409,
                        99.76108271364545,
                        99.33448106786307,
                        99.9829562988851,
                        99.38569832962328,
                        99.06144504894581,
                        94.79523277654108,
                        92.64506335776576,
                        92.73036018917254,
                        89.84642654055163,
                        89.19795914211282,
                        90.68260962875122,
                        89.91467967084354,
                        93.02048690470409,
                        89.88053744053111,
                        88.65188710427832,
                        81.00683157909577,
                        83.87372152660181,
                        79.06143721636258,
                        70.10239536060429,
                        74.47097166328038,
                        65.69968466019904,
                        68.44710421565294,
                        63.395890870184324,
                        64.94880231969785,
                        64.06144896523743,
                        63.7281999627169,
                        69.49979556957761,
                        72.1279562127267,
                        75.66649017245783,
                        73.15859884485062,
                        74.37818688230291,
                        74.34382533965997,
                        71.08011322782322,
                        72.43712393809753,
                        70.92552936513779,
                        74.42971744739245,
                        74.87632351075179,
                        76.01005077080451,
                        77.91672867461726,
                        76.85174016501686,
                        78.15722031020162,
                        74.9622234510675,
                        75.18553823162202,
                        77.72779110187213,
                        76.6112485294325,
                        75.04811555879999,
                        76.2505189086392,
                        75.78673599025,
                        76.85174016501686,
                        77.86519810952771,
                        78.24310458535088
                ],
                "EEM": [
                        100.0,
                        102.02806656358857,
                        100.13371183735036,
                        99.88855272945307,
                        99.82170159679826,
                        100.40114508409181,
                        101.06973298696586,
                        101.60462819657106,
                        103.18697268225716,
                        102.60751962292282,
                        101.80521988269847,
                        102.45152407468755,
                        103.03096756198111,
                        100.4234383670175,
                        101.24804096220834,
                        100.20058211408667,
                        99.39825365774001,
                        95.96612186758556,
                        96.76841203576917,
                        97.23646568476035,
                        95.78783303642459,
                        93.84887260025346,
                        94.89636016449744,
                        97.34787466714425,
                        97.90504401559362,
                        97.99420757525564,
                        96.63471934250035,
                        97.16957626394252,
                        98.43992008111731,
                        99.77711503094689,
                        98.462213364043,
                        98.50679035785362,
                        97.86047659382375,
                        98.57364149050841,
                        97.03586442659217,
                        96.47870465018354,
                        92.86828402886813,
                        92.13281627721702,
                        92.86828402886813,
                        90.63959706302988,
                        90.30530311159286,
                        92.26651854252663,
                        91.64250763346323,
                        93.26941954091919,
                        91.30821368202618,
                        89.43614266667292,
                        83.32961140481855,
                        87.56407165131965,
                        83.48560695305383,
                        75.12814330263932,
                        80.5437838066532,
                        70.49251882796487,
                        75.35099955557016,
                        68.84330885156282,
                        69.37818970310688,
                        69.89078684376602,
                        68.21928358443827,
                        73.34519755878502,
                        75.93045261490447,
                        78.80542941467067,
                        74.32580048823151,
                        75.55158166965681,
                        76.06416923827518,
                        72.81032627928171,
                        75.26185992601005,
                        73.83551577457959,
                        77.8693795489329,
                        78.27054377710623,
                        79.07287701947328,
                        78.78314570378573,
                        78.89457383025116,
                        80.69978892692924,
                        78.62713579748932,
                        79.05058373654758,
                        80.81121705339466,
                        79.78604191615791,
                        77.57968652140839,
                        79.69688792853667,
                        79.40716139886952,
                        79.29573805842448,
                        80.9003710410159,
                        81.0563665892512
                ],
                "LQD": [
                        100.0,
                        100.21101955375961,
                        100.5548800594647,
                        100.21882429672597,
                        99.96096171048484,
                        99.8202650041811,
                        100.29696646183162,
                        100.57833072507228,
                        100.3360411880553,
                        100.46108468437612,
                        100.67991626844382,
                        100.82057653803902,
                        100.8049379027395,
                        101.28945139069808,
                        101.3441793269047,
                        101.47704942821696,
                        101.64897239372779,
                        101.84430958813766,
                        101.78961080129787,
                        102.11785453372855,
                        102.1803653508764,
                        102.44607640413412,
                        102.36534723272308,
                        102.11465539071996,
                        102.05197696471289,
                        102.00495903603044,
                        102.3967192387643,
                        102.63959176311765,
                        102.49071137207892,
                        102.44372988010501,
                        102.37318841239795,
                        102.62395312781815,
                        102.8197931488057,
                        102.6787685121252,
                        103.02353264820174,
                        103.22722113620588,
                        103.24294721960587,
                        103.34477324525363,
                        102.96082507282787,
                        102.41239431077234,
                        103.56413680526583,
                        103.46121039102054,
                        104.6395662574217,
                        104.78886202693766,
                        104.74959782982964,
                        105.4801611231251,
                        102.91916334029882,
                        100.60172309194621,
                        97.29442135774107,
                        92.65161952060221,
                        96.66595372173651,
                        95.29113841030285,
                        91.38681391955139,
                        86.81472115897883,
                        82.52545741732966,
                        83.85309447856338,
                        90.05129924193429,
                        91.8974525275234,
                        96.29673326689708,
                        96.3752689484548,
                        96.17887508949765,
                        97.34939706356568,
                        97.02730384753424,
                        95.61761131869915,
                        95.86958573284241,
                        95.37342707283881,
                        97.25568184923583,
                        97.40534198583704,
                        99.16159133680816,
                        103.82390867503372,
                        102.81587984630995,
                        102.31179984587273,
                        102.99696300034434,
                        102.48509283162414,
                        102.82375017535168,
                        102.24098145918086,
                        101.87869126630315,
                        101.94170491002868,
                        102.37483535162333,
                        102.30395137885615,
                        101.47705671555866,
                        101.75265669151044
                ],
                "HYG": [
                        100.0,
                        100.4207688342744,
                        100.31844510293568,
                        100.21608606726183,
                        100.12518917239576,
                        100.21608606726183,
                        100.47764411818008,
                        100.5117363378107,
                        100.5117363378107,
                        100.50036834189659,
                        100.52312786994824,
                        100.5572436258023,
                        100.47764411818008,
                        100.26162865958854,
                        100.44351659421433,
                        100.13646302341618,
                        99.71574126158865,
                        99.04482944475696,
                        99.89768803677299,
                        99.84084805720244,
                        99.94318355665287,
                        99.53382979073943,
                        99.51783692692237,
                        100.11164407581488,
                        100.52272775415003,
                        100.60262146456505,
                        100.45419027153741,
                        100.5912181643158,
                        100.65975564692839,
                        100.92238459601248,
                        100.95667687354222,
                        100.94517942839927,
                        100.7397199660137,
                        100.78533316701068,
                        100.95667687354222,
                        100.86533279043111,
                        99.78051294845332,
                        99.08387603941846,
                        99.18668226333739,
                        97.85066619280404,
                        98.2503230346665,
                        98.99587410003366,
                        98.57142773084917,
                        99.92491944727533,
                        98.66324253842876,
                        97.55065583686573,
                        93.35272325873134,
                        94.78646761297975,
                        92.72186421011257,
                        89.01711554167441,
                        91.81571960826311,
                        86.7690590453237,
                        87.5833594193143,
                        83.7180878230641,
                        81.83699635423899,
                        80.0018652457064,
                        78.71722286685323,
                        81.96320935235374,
                        84.26862950924621,
                        88.12244484874446,
                        88.3518583025205,
                        89.10889504491888,
                        88.39774217008687,
                        85.97122814367452,
                        86.63985106277818,
                        84.78391981679404,
                        86.84734052443414,
                        86.84734052443414,
                        89.10670029208453,
                        94.93956486230132,
                        93.5793417859757,
                        93.97122579005219,
                        93.09512517740428,
                        93.00292202213816,
                        93.47561176528738,
                        92.06922827077013,
                        90.3862411945104,
                        91.18161844486757,
                        91.13549921506696,
                        90.28248763759863,
                        90.65133556299824,
                        90.92802152152271
                ],
                "EMB": [
                        100.0,
                        100.12220055605529,
                        99.86906335219986,
                        99.66832524408474,
                        99.82543525766191,
                        100.08733473535534,
                        100.01748963821846,
                        100.03491818488625,
                        100.13093664780016,
                        100.10476328202311,
                        100.48010976929824,
                        100.68959269652258,
                        100.56740959519604,
                        100.48010976929824,
                        100.55865604872243,
                        100.32300848308545,
                        100.19201074373466,
                        100.06985382450127,
                        100.54121004732588,
                        101.0038563604988,
                        100.93404617281945,
                        101.23952138086455,
                        101.21415965997491,
                        101.09147909887868,
                        101.12651946686626,
                        101.37181949750804,
                        101.37181949750804,
                        101.389344045184,
                        101.34554140335845,
                        101.49446514914673,
                        101.52073451593193,
                        101.92370311147123,
                        102.01129966775797,
                        102.2127446923879,
                        102.27411551871133,
                        102.50189972904151,
                        102.05514594640543,
                        101.42436695844282,
                        101.37181949750804,
                        100.11034879522663,
                        99.97020477800508,
                        100.77642124474384,
                        101.94580952544695,
                        102.70196583009934,
                        101.79631850097392,
                        101.3743329784496,
                        93.16240673829331,
                        94.24385809549884,
                        89.97960676765217,
                        85.5483398676565,
                        87.97497480628087,
                        83.91294523849399,
                        83.09527846968807,
                        75.43722568257371,
                        77.35395562990495,
                        80.08831743658456,
                        80.31696565598841,
                        82.82270542535734,
                        86.14615560035409,
                        87.57051383143252,
                        85.76812981221418,
                        85.65381006619444,
                        85.00319377899504,
                        82.86553060237229,
                        84.56081240591355,
                        84.41072792066268,
                        86.11482436222822,
                        86.60929064593232,
                        86.98014254055147,
                        89.48772378380468,
                        89.31114302029471,
                        89.9027448695534,
                        88.11915959321055,
                        87.54521320209355,
                        88.16331132961135,
                        87.60703785136478,
                        86.3797347806329,
                        86.45036534056402,
                        86.86537769894834,
                        86.48568498421176,
                        86.3355481347746,
                        87.18321958232056
                ]
        },
        "min_value": 63.395890870184324,
        "max_value": 105.4801611231251,
        "corr_2019": {
                "SPY": {
                        "SPY": 1.0,
                        "VGK": 0.8311049720121608,
                        "EEM": 0.7642129998030799,
                        "LQD": -0.033660311469121386,
                        "HYG": 0.8086051942936187,
                        "EMB": 0.4294171700086891
                },
                "VGK": {
                        "SPY": 0.8311049720121608,
                        "VGK": 1.0,
                        "EEM": 0.7633114419227764,
                        "LQD": 0.001195813046174524,
                        "HYG": 0.7259004514590809,
                        "EMB": 0.43144163406646086
                },
                "EEM": {
                        "SPY": 0.7642129998030799,
                        "VGK": 0.7633114419227764,
                        "EEM": 1.0,
                        "LQD": 0.016519884312023548,
                        "HYG": 0.6657013282958533,
                        "EMB": 0.46861501059146604
                },
                "LQD": {
                        "SPY": -0.033660311469121386,
                        "VGK": 0.001195813046174524,
                        "EEM": 0.016519884312023548,
                        "LQD": 1.0,
                        "HYG": 0.1356406778429692,
                        "EMB": 0.5365931544340999
                },
                "HYG": {
                        "SPY": 0.8086051942936187,
                        "VGK": 0.7259004514590809,
                        "EEM": 0.6657013282958533,
                        "LQD": 0.1356406778429692,
                        "HYG": 1.0,
                        "EMB": 0.5243883240708539
                },
                "EMB": {
                        "SPY": 0.4294171700086891,
                        "VGK": 0.43144163406646086,
                        "EEM": 0.46861501059146604,
                        "LQD": 0.5365931544340999,
                        "HYG": 0.5243883240708539,
                        "EMB": 1.0
                }
        },
        "corr_2020": {
                "SPY": {
                        "SPY": 1.0,
                        "VGK": 0.972150139658278,
                        "EEM": 0.9618732930209337,
                        "LQD": 0.6391454596026617,
                        "HYG": 0.9631233106396802,
                        "EMB": 0.8544999649261714
                },
                "VGK": {
                        "SPY": 0.972150139658278,
                        "VGK": 1.0,
                        "EEM": 0.9796988678186902,
                        "LQD": 0.7263165634720272,
                        "HYG": 0.9801112666943178,
                        "EMB": 0.8868188081760914
                },
                "EEM": {
                        "SPY": 0.9618732930209337,
                        "VGK": 0.9796988678186902,
                        "EEM": 1.0,
                        "LQD": 0.6894385303900435,
                        "HYG": 0.9705853144768011,
                        "EMB": 0.8425169857551853
                },
                "LQD": {
                        "SPY": 0.6391454596026617,
                        "VGK": 0.7263165634720272,
                        "EEM": 0.6894385303900435,
                        "LQD": 1.0,
                        "HYG": 0.92598209943899,
                        "EMB": 0.8372116312285793
                },
                "HYG": {
                        "SPY": 0.9631233106396802,
                        "VGK": 0.9801112666943178,
                        "EEM": 0.9705853144768011,
                        "LQD": 0.92598209943899,
                        "HYG": 1.0,
                        "EMB": 0.9133261429356787
                },
                "EMB": {
                        "SPY": 0.8544999649261714,
                        "VGK": 0.8868188081760914,
                        "EEM": 0.8425169857551853,
                        "LQD": 0.8372116312285793,
                        "HYG": 0.9133261429356787,
                        "EMB": 1.0
                }
        },
        "vol_2019": {
                "SPY": 0.12510922031685315,
                "VGK": 0.1202567618371666,
                "EEM": 0.15121574472829893,
                "LQD": 0.048573005147406964,
                "HYG": 0.04591050744488068,
                "EMB": 0.05509685830801823
        },
        "drawdown_2020": {
                "SPY": -0.33717266516773664,
                "VGK": -0.37129818951265664,
                "EEM": -0.33887697437829306,
                "LQD": -0.2176210527304829,
                "HYG": -0.22028710428480142,
                "EMB": -0.26547437458626544
        },
        "vol_2020": {
                "SPY": 0.3273463274565047,
                "VGK": 0.3300573519771426,
                "EEM": 0.3341513054522452,
                "LQD": 0.16873978941206816,
                "HYG": 0.17202169166587955,
                "EMB": 0.18962208150853724
        },
        "etfs": [
                "SPY",
                "VGK",
                "EEM",
                "LQD",
                "HYG",
                "EMB"
        ]
};
        
        // Replace EEM with EM for display
        const etfsDisplay = ["SPY", "VGK", "EM", "LQD", "HYG", "EMB"];
        
        function createChart() {
            const ctx = document.getElementById('etfChart').getContext('2d');
            const colors = {
                'SPY': '#4472C4',
                'VGK': '#ED7D31',
                'EEM': '#70AD47',
                'LQD': '#FFC000',
                'HYG': '#5B9BD5',
                'EMB': '#C55A11'
            };
            
            const datasets = data.etfs.map((etf, idx) => ({
                label: etfsDisplay[idx],
                data: data.chart_data[etf],
                borderColor: colors[etf],
                backgroundColor: 'transparent',
                borderWidth: 2.5,
                pointRadius: 0,
                pointHoverRadius: 5,
                pointHoverBorderWidth: 2,
                tension: 0,
                fill: false,
                spanGaps: false
            }));
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.dates,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    aspectRatio: 1.5,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            type: 'category',
                            title: {
                                display: false
                            },
                            ticks: {
                                maxRotation: 0,
                                minRotation: 0,
                                autoSkip: true,
                                maxTicksLimit: 8,
                                callback: function(value, index, ticks) {
                                    const date = data.dates[index];
                                    if (date) {
                                        const parts = date.split('-');
                                        return parts[1] + '/' + parts[2]; // MM/DD format
                                    }
                                    return value;
                                }
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: false
                            },
                            min: Math.floor(data.min_value / 5) * 5,
                            max: Math.ceil(data.max_value / 5) * 5,
                            ticks: {
                                stepSize: 5
                            },
                            grid: {
                                color: '#e0e0e0'
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
            
            // Create custom legend
            const legendContainer = document.getElementById('chartLegend');
            let legendHTML = '<strong>ETFs:</strong> ';
            data.etfs.forEach((etf, idx) => {
                legendHTML += `
                    <span class="legend-item">
                        <span class="legend-color" style="background-color: ${colors[etf]}"></span>
                        <span>${etfsDisplay[idx]}</span>
                    </span>
                `;
            });
            legendContainer.innerHTML = legendHTML;
        }
        
        function createCorrelationTables() {
            // 2019 Correlation Table
            const corr2019Table = document.getElementById('corr2019Table');
            let html2019 = '<thead><tr><th></th>';
            etfsDisplay.forEach(etf => {
                html2019 += `<th>${etf}</th>`;
            });
            html2019 += '</tr></thead><tbody>';
            
            data.etfs.forEach((rowEtf, rowIdx) => {
                html2019 += `<tr><td class="etf-label">${etfsDisplay[rowIdx]}</td>`;
                data.etfs.forEach(colEtf => {
                    const value = data.corr_2019[rowEtf][colEtf];
                    const displayValue = value.toFixed(2);
                    const bgClass = (rowEtf === colEtf) ? 'correlation-high' : '';
                    html2019 += `<td class="${bgClass}">${displayValue}</td>`;
                });
                html2019 += '</tr>';
            });
            html2019 += '</tbody>';
            corr2019Table.innerHTML = html2019;
            
            // 2020 Correlation Table
            const corr2020Table = document.getElementById('corr2020Table');
            let html2020 = '<thead><tr><th></th>';
            etfsDisplay.forEach(etf => {
                html2020 += `<th>${etf}</th>`;
            });
            html2020 += '</tr></thead><tbody>';
            
            data.etfs.forEach((rowEtf, rowIdx) => {
                html2020 += `<tr><td class="etf-label">${etfsDisplay[rowIdx]}</td>`;
                data.etfs.forEach(colEtf => {
                    const value = data.corr_2020[rowEtf][colEtf];
                    const displayValue = value.toFixed(2);
                    const bgClass = (rowEtf === colEtf) ? 'correlation-high' : '';
                    html2020 += `<td class="${bgClass}">${displayValue}</td>`;
                });
                html2020 += '</tr>';
            });
            html2020 += '</tbody>';
            corr2020Table.innerHTML = html2020;
        }
        
        function createMetricsTables() {
            // Volatility Dec 2019 Table
            const vol2019Table = document.getElementById('vol2019Table');
            let htmlVol2019 = '<thead><tr><th>ETF</th><th>VOL</th></tr></thead><tbody>';
            data.etfs.forEach((etf, idx) => {
                const vol = (data.vol_2019[etf] * 100).toFixed(1) + '%';
                htmlVol2019 += `<tr><td class="etf-label">${etfsDisplay[idx]}</td><td>${vol}</td></tr>`;
            });
            htmlVol2019 += '</tbody>';
            vol2019Table.innerHTML = htmlVol2019;
            
            // Drawdown & Vol Sept 2020 Table
            const metrics2020Table = document.getElementById('metrics2020Table');
            let htmlMetrics2020 = '<thead><tr><th>ETF</th><th>DRAWDOWN</th><th>VOL</th></tr></thead><tbody>';
            data.etfs.forEach((etf, idx) => {
                const dd = (data.drawdown_2020[etf] * 100).toFixed(1) + '%';
                const vol = (data.vol_2020[etf] * 100).toFixed(1) + '%';
                htmlMetrics2020 += `<tr><td class="etf-label">${etfsDisplay[idx]}</td><td>${dd}</td><td>${vol}</td></tr>`;
            });
            htmlMetrics2020 += '</tbody>';
            metrics2020Table.innerHTML = htmlMetrics2020;
        }
        
        // Initialize everything when page loads
        window.addEventListener('DOMContentLoaded', () => {
            createChart();
            createCorrelationTables();
            createMetricsTables();
        });
    </script>
</body>
</html>
